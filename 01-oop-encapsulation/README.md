# –ú–æ–¥—É–ª—å 01: –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è

> **–£—Ä–æ–≤–µ–Ω—å**: ‚≠ê‚≠ê –°—Ä–µ–¥–Ω–∏–π  
> **–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞  
> **–ü—Ä–µ—Ä–µ–∫–≤–∏–∑–∏—Ç—ã**: –ë–∞–∑–æ–≤–æ–µ –∑–Ω–∞–Ω–∏–µ Java

## üìã –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ

**–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è** ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ ¬´—Å–¥–µ–ª–∞—Ç—å –ø–æ–ª—è private –∏ –¥–æ–±–∞–≤–∏—Ç—å –≥–µ—Ç—Ç–µ—Ä—ã/—Å–µ—Ç—Ç–µ—Ä—ã¬ª. –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø, –∫–æ—Ç–æ—Ä—ã–π:

1. **–°–∫—Ä—ã–≤–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ** ‚Äî –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏
2. **–ó–∞—â–∏—â–∞–µ—Ç –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã** ‚Äî –æ–±—ä–µ–∫—Ç –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
3. **–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø** ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –º–æ–∂–Ω–æ —á–∏—Ç–∞—Ç—å, —á—Ç–æ –∏–∑–º–µ–Ω—è—Ç—å, –∞ —á—Ç–æ –≤–æ–æ–±—â–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –¥–∞–∂–µ –æ–ø—ã—Ç–Ω—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

- –í–æ–∑–≤—Ä–∞—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ mutable –ø–æ–ª–µ (–∫–æ–ª–ª–µ–∫—Ü–∏—é, –º–∞—Å—Å–∏–≤, Date)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ mutable –∞—Ä–≥—É–º–µ–Ω—Ç –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—É–±–ª–∏—á–Ω—ã–µ —Å–µ—Ç—Ç–µ—Ä—ã, –Ω–∞—Ä—É—à–∞—é—â–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∫–ª–∞—Å—Å–∞
- –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç mutable –∫–ª–∞—Å—Å–æ–≤ –≤ immutable –∫–ª–∞—Å—Å–∞—Ö

### Defensive Copying

**Defensive copy** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ø–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ, —á—Ç–æ–±—ã –≤–Ω–µ—à–Ω–∏–π –∫–æ–¥ –Ω–µ –º–æ–≥ –∏–∑–º–µ–Ω–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

```java
// –ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢ –ë–ï–ó DEFENSIVE COPY:
List<String> external = new ArrayList<>();
external.add("A");
MyClass obj = new MyClass(external);  // obj —Ö—Ä–∞–Ω–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ external
external.add("B");                     // –£–ø—Å! –ú—ã –∏–∑–º–µ–Ω–∏–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ obj –∏–∑–≤–Ω–µ!
```

### Records (Java 14+) ‚Äî –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è immutable –∫–ª–∞—Å—Å–æ–≤

```java
// –í–º–µ—Å—Ç–æ –≥—Ä–æ–º–æ–∑–¥–∫–æ–≥–æ:
public final class Point {
    private final int x;
    private final int y;
    
    public Point(int x, int y) {
        this.x = x;
        this.y = y;
    }
    
    public int x() { return x; }
    public int y() { return y; }
    
    @Override
    public boolean equals(Object o) { ... }
    
    @Override
    public int hashCode() { ... }
    
    @Override
    public String toString() { ... }
}

// –ü—Ä–æ—Å—Ç–æ:
public record Point(int x, int y) { }
```

**–ß—Ç–æ –¥–∞—ë—Ç record:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ `equals()`, `hashCode()`, `toString()`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ accessors (–±–µ–∑ get-–ø—Ä–µ—Ñ–∏–∫—Å–∞: `point.x()`)
- –í—Å–µ –ø–æ–ª—è `private final`
- –ö–ª–∞—Å—Å –Ω–µ—è–≤–Ω–æ `final`

**Compact Constructor –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
```java
public record Person(String name, int age) {
    public Person {
        if (name == null || name.isBlank()) {
            throw new IllegalArgumentException("Name required");
        }
        if (age < 0 || age > 150) {
            throw new IllegalArgumentException("Invalid age");
        }
        // –ù–µ –Ω—É–∂–Ω–æ this.name = name; ‚Äî –¥–µ–ª–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
    }
}
```

**‚ö†Ô∏è Records –ù–ï –¥–µ–ª–∞—é—Ç defensive copy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!**
```java
public record Container(List<String> items) { }

List<String> list = new ArrayList<>();
list.add("A");
Container c = new Container(list);
list.add("B");  // –£–ø—Å! c.items() —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç –∏ "B"!

// –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
public record Container(List<String> items) {
    public Container {
        items = List.copyOf(items);  // defensive copy!
    }
}
```

### Sealed Classes (Java 17) ‚Äî –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

```java
// –¢–æ–ª—å–∫–æ Circle, Rectangle –∏ Triangle –º–æ–≥—É—Ç –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –æ—Ç Shape
public sealed abstract class Shape 
    permits Circle, Rectangle, Triangle {
    public abstract double area();
}

public final class Circle extends Shape { ... }
public final class Rectangle extends Shape { ... }
public non-sealed class Triangle extends Shape { ... }  // –º–æ–∂–Ω–æ –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å –¥–∞–ª—å—à–µ
```

**–ó–∞—á–µ–º?**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∏–µ—Ä–∞—Ä—Ö–∏–µ–π
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∑–Ω–∞–µ—Ç –≤—Å–µ –ø–æ–¥—Ç–∏–ø—ã ‚Üí exhaustive switch
- Pattern matching —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ default branch

## üéØ –ó–∞–¥–∞–Ω–∏–µ

### –ó–∞–¥–∞—á–∞ 1: BankAccount —Å –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏

–†–µ–∞–ª–∏–∑—É–π –∫–ª–∞—Å—Å `BankAccount`, –∫–æ—Ç–æ—Ä—ã–π:
- –•—Ä–∞–Ω–∏—Ç –±–∞–ª–∞–Ω—Å (–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º)
- –•—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –ó–∞—â–∏—â—ë–Ω –æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
1. –ë–∞–ª–∞–Ω—Å –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
2. –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞ –∏–∑–≤–Ω–µ
3. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—á—ë—Ç–∞ –∑–∞–¥–∞—ë—Ç—Å—è –Ω–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å (‚â• 0)
4. –ú–µ—Ç–æ–¥—ã `deposit()` –∏ `withdraw()` –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤

### –ó–∞–¥–∞—á–∞ 2: ImmutablePerson

–°–æ–∑–¥–∞–π **–ø–æ–ª–Ω–æ—Å—Ç—å—é immutable** –∫–ª–∞—Å—Å `Person`:
- –ò–º—è (String)
- –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è (LocalDate)
- –°–ø–∏—Å–æ–∫ —Ö–æ–±–±–∏ (List<String>)
- –ê–¥—Ä–µ—Å (–∫–ª–∞—Å—Å Address, —Ç–æ–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å immutable)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
1. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω—ë–Ω
2. –î–∞–∂–µ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∏—Ç —Å–ø–∏—Å–æ–∫ —Ö–æ–±–±–∏, –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —ç—Ç–æ–º —Å–ø–∏—Å–∫–µ –Ω–µ –ø–æ–≤–ª–∏—è—é—Ç –Ω–∞ Person
3. –ö–ª–∞—Å—Å Address —Ç–∞–∫–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å immutable

### –ó–∞–¥–∞—á–∞ 3: AuditLog ‚Äî –∑–∞—â–∏—Ç–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

–°–æ–∑–¥–∞–π –∫–ª–∞—Å—Å `AuditLog` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –∞—É–¥–∏—Ç–∞:
- –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∏—Ç: timestamp, action, user
- –ó–∞–ø–∏—Å–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å, –Ω–æ –Ω–µ–ª—å–∑—è —É–¥–∞–ª—è—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω—è—Ç—å
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–ø–∏—Å–æ–∫

## üß™ –¢–µ—Å—Ç—ã

–¢–µ—Å—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `src/test/java`. –ó–∞–ø—É—Å—Ç–∏ –∏—Ö –∫–æ–º–∞–Ω–¥–æ–π:

```bash
mvn test
```

–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç:
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- –ó–∞—â–∏—Ç—É –æ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–æ—Å–ª–µ –ª—é–±—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## ü§î –ú–µ—Ç–∞-–≤–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è

1. –ü–æ—á–µ–º—É `String` –≤ Java immutable? –ö–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —ç—Ç–æ –¥–∞—ë—Ç?
2. –ü–æ—á–µ–º—É `java.util.Date` —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–ª–æ—Ö–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–ª–∞—Å—Å–æ–º?
3. –ö–æ–≥–¥–∞ –ù–ï –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å defensive copy? (–ø–æ–¥—Å–∫–∞–∑–∫–∞: –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
4. –ö–∞–∫ —Å–≤—è–∑–∞–Ω—ã –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –∏ thread-safety?

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- [ ] –í—Å–µ –ø–æ–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ
- [ ] –ù–µ—Ç public —Å–µ—Ç—Ç–µ—Ä–æ–≤ –¥–ª—è –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω—è—Ç—å—Å—è
- [ ] –î–ª—è mutable –ø–æ–ª–µ–π —Å–¥–µ–ª–∞–Ω defensive copy –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ

### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã
- [ ] –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã
- [ ] –ú–µ—Ç–æ–¥—ã –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–∞—Ä—É—à–∏—Ç—å –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∫–ª–∞—Å—Å–∞
- [ ] –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç –≤ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏

### Immutability (–¥–ª—è immutable –∫–ª–∞—Å—Å–æ–≤)
- [ ] –ö–ª–∞—Å—Å –æ–±—ä—è–≤–ª–µ–Ω –∫–∞–∫ `final`
- [ ] –í—Å–µ –ø–æ–ª—è `final`
- [ ] –ù–µ—Ç –º–µ—Ç–æ–¥–æ–≤, –∏–∑–º–µ–Ω—è—é—â–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- [ ] Mutable –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ
- [ ] Mutable –ø–æ–ª—è –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ

### –¢–µ—Å—Ç—ã
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ü–æ–∫—Ä—ã—Ç–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- [ ] –ï—Å—Ç—å –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã (–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã)

