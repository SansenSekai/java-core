# –ú–æ–¥—É–ª—å 17: CompletableFuture

> **–£—Ä–æ–≤–µ–Ω—å**: ‚≠ê‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω—ã–π  
> **–í—Ä–µ–º—è**: 5-7 —á–∞—Å–æ–≤

## üìã –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ CompletableFuture

```java
CompletableFuture.supplyAsync(() -> compute())       // —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
CompletableFuture.runAsync(() -> action())           // –±–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
CompletableFuture.completedFuture(value)             // —É–∂–µ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–π
```

### –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è

```java
.thenApply(fn)      // T ‚Üí U (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
.thenApplyAsync(fn) // T ‚Üí U (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
.thenCompose(fn)    // T ‚Üí CompletableFuture<U> (flatMap)
```

### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```java
.thenCombine(other, fn)          // –æ–±–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
.thenAcceptBoth(other, action)   // –æ–±–∞ –±–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
CompletableFuture.allOf(...)     // –∂–¥–∞—Ç—å –≤—Å–µ—Ö
CompletableFuture.anyOf(...)     // –∂–¥–∞—Ç—å –ª—é–±–æ–≥–æ
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```java
.exceptionally(ex -> fallback)
.handle((result, ex) -> ...)
.whenComplete((result, ex) -> ...)
```

## üéØ –ó–∞–¥–∞–Ω–∏–µ

### –ó–∞–¥–∞—á–∞ 1: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã

–í—ã–ø–æ–ª–Ω–∏ 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –æ–±—ä–µ–¥–∏–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

### –ó–∞–¥–∞—á–∞ 2: Fallback –ø—Ä–∏ –æ—à–∏–±–∫–µ

–ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–π.

### –ó–∞–¥–∞—á–∞ 3: Timeout

–†–µ–∞–ª–∏–∑—É–π timeout –¥–ª—è CompletableFuture (orTimeout –ø–æ—è–≤–∏–ª—Å—è –≤ Java 9).

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç

- [ ] –ü–æ–Ω–∏–º–∞–µ—à—å —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É thenApply –∏ thenCompose
- [ ] –£–º–µ–µ—à—å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ futures
- [ ] –ó–Ω–∞–µ—à—å –ø—Ä–æ –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- [ ] –ü–æ–Ω–∏–º–∞–µ—à—å, –∫–∞–∫–æ–π executor –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

