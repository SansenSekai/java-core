# –ú–æ–¥—É–ª—å 05: –ì–ª—É–±–æ–∫–æ–µ –ø–æ–≥—Ä—É–∂–µ–Ω–∏–µ –≤ Generics

> **–£—Ä–æ–≤–µ–Ω—å**: ‚≠ê‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω—ã–π  
> **–í—Ä–µ–º—è**: 4-6 —á–∞—Å–æ–≤  
> **–ü—Ä–µ—Ä–µ–∫–≤–∏–∑–∏—Ç—ã**: –ú–æ–¥—É–ª–∏ 01-02 (–û–û–ü)

## üìã –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ

### Type Erasure ‚Äî –∫–ª—é—á –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é Generics

Java Generics —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ **type erasure** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∏–ø–∞—Ö —Å—Ç–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

```java
// –í runtime –æ–±–∞ —Å–ø–∏—Å–∫–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ ArrayList
List<String> strings = new ArrayList<>();
List<Integer> integers = new ArrayList<>();

strings.getClass() == integers.getClass() // true!
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è type erasure:**
- –ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ generic-—Ç–∏–ø–∞: `new T[]` ‚Äî –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å instanceof —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º —Ç–∏–ø–æ–º
- –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ –ø–æ generic-—Ç–∏–ø—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### PECS: Producer Extends, Consumer Super

–ú–Ω–µ–º–æ–Ω–∏–∫–∞ –¥–ª—è wildcard'–æ–≤:
- **Producer Extends**: –µ—Å–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏—è *–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç* —ç–ª–µ–º–µ–Ω—Ç—ã (–º—ã –∏–∑ –Ω–µ—ë —á–∏—Ç–∞–µ–º) ‚Äî `? extends T`
- **Consumer Super**: –µ—Å–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏—è *–ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç* —ç–ª–µ–º–µ–Ω—Ç—ã (–º—ã –≤ –Ω–µ—ë –ø–∏—à–µ–º) ‚Äî `? super T`

```java
void copy(List<? extends T> source,    // —á–∏—Ç–∞–µ–º –∏–∑ source (producer)
          List<? super T> destination) // –ø–∏—à–µ–º –≤ destination (consumer)
```

### –ö–æ–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å vs –ö–æ–Ω—Ç—Ä–∞–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å

| –¢–∏–ø | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä | –û–ø–µ—Ä–∞—Ü–∏–∏ |
|-----|-------------|--------|----------|
| **–ö–æ–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å** | ‚Üë –≤–≤–µ—Ä—Ö –ø–æ –∏–µ—Ä–∞—Ä—Ö–∏–∏ | `List<? extends Number>` | –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ |
| **–ö–æ–Ω—Ç—Ä–∞–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å** | ‚Üì –≤–Ω–∏–∑ –ø–æ –∏–µ—Ä–∞—Ä—Ö–∏–∏ | `List<? super Integer>` | –¢–æ–ª—å–∫–æ –∑–∞–ø–∏—Å—å |
| **–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å** | –¢–æ—á–Ω—ã–π —Ç–∏–ø | `List<Number>` | –ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å |

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ Senior-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

1. **Heap Pollution**: —Å–º–µ—à–∏–≤–∞–Ω–∏–µ raw types –∏ generics
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã**: `? extends Object` –≤–º–µ—Å—Ç–æ unbounded `?`
3. **–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ wildcards**: —É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ API –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
4. **Recursive type bounds**: `<T extends Comparable<T>>` vs `<T extends Comparable<? super T>>`

## üéØ –ó–∞–¥–∞–Ω–∏–µ

### –ó–∞–¥–∞—á–∞ 1: Generic Repository

–°–æ–∑–¥–∞–π –æ–±–æ–±—â—ë–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π:

```java
public interface Repository<T, ID> {
    T save(T entity);
    Optional<T> findById(ID id);
    List<T> findAll();
    void delete(T entity);
}
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
1. –†–µ–∞–ª–∏–∑—É–π `InMemoryRepository<T, ID>`
2. –î–æ–±–∞–≤—å –º–µ—Ç–æ–¥ `findAll(Predicate<T> filter)`
3. –î–æ–±–∞–≤—å –º–µ—Ç–æ–¥ `<S extends T> List<S> saveAll(Iterable<S> entities)`

### –ó–∞–¥–∞—á–∞ 2: Pair –∏ Triple

–°–æ–∑–¥–∞–π –æ–±–æ–±—â—ë–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä –∏ —Ç—Ä–æ–µ–∫ –∑–Ω–∞—á–µ–Ω–∏–π:

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
1. `Pair<K, V>` ‚Äî immutable –ø–∞—Ä–∞
2. `Triple<A, B, C>` ‚Äî immutable —Ç—Ä–æ–π–∫–∞
3. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–±—Ä–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã `of()`
4. –†–µ–∞–ª–∏–∑—É–π `Comparable` –¥–ª—è `Pair`, –µ—Å–ª–∏ –æ–±–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ `Comparable`

### –ó–∞–¥–∞—á–∞ 3: Generic Utility Methods

–†–µ–∞–ª–∏–∑—É–π utility-–∫–ª–∞—Å—Å —Å –æ–±–æ–±—â—ë–Ω–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏:

1. `<T extends Comparable<? super T>> T max(Collection<T> collection)` ‚Äî –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º—É–º
2. `<T> void copy(List<? extends T> src, List<? super T> dest)` ‚Äî —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã
3. `<T> List<T> filter(List<T> list, Predicate<? super T> predicate)` ‚Äî –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å
4. `<K, V> Map<V, K> invert(Map<K, V> map)` ‚Äî –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å map

### –ó–∞–¥–∞—á–∞ 4: Type-safe Builder

–°–æ–∑–¥–∞–π generic builder —Å compile-time –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π:

```java
Person person = Person.builder()
    .name("John")     // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
    .age(30)          // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
    .email("...")     // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ
    .build();         // –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ name –∏ age –∑–∞–¥–∞–Ω—ã
```

## üß™ –¢–µ—Å—Ç—ã

```bash
mvn test
```

## ü§î –ú–µ—Ç–∞-–≤–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è

1. –ü–æ—á–µ–º—É –≤ Java –º–∞—Å—Å–∏–≤—ã –∫–æ–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã (`String[]` ‚Äî –ø–æ–¥—Ç–∏–ø `Object[]`), –∞ generics –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã?
2. –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å `new T[]`?
3. –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `List<?>` –∏ `List<Object>`?
4. –ü–æ—á–µ–º—É `Comparable<? super T>` –ª—É—á—à–µ —á–µ–º `Comparable<T>` –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö?
5. –ö–∞–∫ —Å–≤—è–∑–∞–Ω—ã generics –∏ reflection?

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏

### Type Parameters
- [ ] –ù–∞–∑–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ (T ‚Äî —Ç–∏–ø, E ‚Äî —ç–ª–µ–º–µ–Ω—Ç, K/V ‚Äî –∫–ª—é—á/–∑–Ω–∞—á–µ–Ω–∏–µ)
- [ ] –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã
- [ ] –ù–µ—Ç raw types

### Wildcards
- [ ] PECS –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –ù–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö wildcards
- [ ] Unbounded wildcard `?` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

### API Design
- [ ] –ü—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≥–∏–±–∫–∏–µ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
- [ ] –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è
- [ ] –ù–µ—Ç heap pollution warnings

